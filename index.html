
<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>中国药物研发统计编程行业 AI 使用与态度（2025）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="color-scheme" content="light dark" />
  <style>
    .matrix th, .matrix td { border: 1px solid #e5e7eb; padding: 8px; }
    .matrix td { text-align: center; }
    .matrix th:first-child, .matrix td:first-child { text-align: left !important; }
    .hidden-important { display: none !important; }
    .indent-row { padding-left: 2rem !important; }
    .required-star { color: #ef4444; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <div class="max-w-4xl mx-auto p-6">
    <header class="mb-6">
      <h1 class="text-2xl font-bold">中国药物研发统计编程行业 AI 使用与态度（2025）</h1>
      <p class="text-sm text-gray-600 mt-2">本问卷不收集任何可识别个人信息（PII）。请勿填写姓名、电话、邮箱、公司名、项目名、身份证号、精确地址等。</p>
      <div class="mt-3 flex gap-3">
        <button id="resetBtn" class="px-3 py-1.5 rounded bg-gray-200 hover:bg-gray-300 text-sm">重置答卷</button>
        <span id="autosaveHint" class="text-xs text-gray-500 self-center">已开启自动保存</span>
      </div>
    </header>

    <section class="mb-6">
      <details class="bg-white p-4 rounded border">
        <summary class="cursor-pointer font-medium">填写说明</summary>
        <div class="text-sm text-gray-700 mt-2 space-y-2">
          <p>AI 定义：本问卷中的"AI"指生成式 AI/大语言模型及其衍生工具（ChatGPT/Claude/Gemini/DeepSeek、Copilot、代码/文档/图表生成、RAG、自动化工作流等），不包含仅规则驱动的传统宏/脚本。</p>
          <p>年份口径：2023 年（2023.01–12）、2024 年（2024.01–12）、2025 年（2025.01–填写当月）。</p>
          <p>隐私：不收集任何可识别个人信息（PII）。</p>
        </div>
      </details>
    </section>

    <form id="surveyForm" class="space-y-10">
      <!-- A. 筛选与分支 S -->
      <div id="blockA" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">A. 筛选与分支（S）</h2>
        <p class="text-sm text-red-600 mb-4">本部分所有问题均为必填项</p>

        <!-- 必填验证提示 -->
        <div id="sSectionValidation" class="bg-red-50 border border-red-200 rounded p-3 text-sm text-red-700 hidden">
          <strong>请完成前面的必填项：</strong>
          <ul id="sMissingItems" class="list-disc list-inside mt-1"></ul>
        </div>

        <!-- S1 -->
        <div>
          <label class="font-medium">S1 您目前的主要工作地点在中国大陆吗？ <span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="S1" value="A" required> <span>A. 是</span></label>
            <label class="flex items-center gap-2"><input type="radio" name="S1" value="B"> <span>B. 否（将结束问卷）</span></label>
          </div>
          <p id="endMsgS1" class="mt-2 text-sm text-red-600 hidden">您选择了"否"，问卷将在此结束。非常感谢您的时间！</p>
        </div>

        <!-- S2 单选 -->
        <div>
          <label class="font-medium">S2 您所在的组织类型 <span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="A" required> A. 跨国药企（MNC）在华机构</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="B"> B. 本土药企（Local）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="C"> C. CRO/服务外包公司</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="D"> D. 其他医药相关机构</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="E"> E. 不方便透露</label>
          </div>
        </div>

        <!-- S3 多选 -->
        <div>
          <label class="font-medium">S3 您近一年在统计编程相关的主要工作内容（可多选） <span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="A"> A. 生成/映射 SDTM</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="B"> B. 生成 ADaM</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="C"> C. 生成/校对 TLF（表/图/列表）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="D"> D. 编程 QC/Validation（含双编、审计追踪）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="E"> E. Define.xml/ADRGS/数据集说明文档的编程支持</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="F"> F. 将 SAP/统计方法转化为可运行代码</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="G"> G. 工具与宏/包开发与维护（SAS/R/Python）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="H"> H. 自动化流水线/作业编排（如 CI/CD）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="I"> I. 带人经理（已不参与编程）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="J"> J. 项目管理（PM/交付协调）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="K"> <span>K. 其他：</span> <input type="text" name="S3-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- S5 -->
        <div>
          <label class="font-medium">S5 您在 2025 年工作中使用 AI 的频率？ <span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="A" required> A. 从不</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="B"> B. 很少（每季度或更少）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="C"> C. 偶尔（每月）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="D"> D. 经常（每周）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="E"> E. 频繁（几乎每天）</label>
          </div>
        </div>

        <!-- S6 多选，每行一个 -->
        <div>
          <label class="font-medium">S6 您在工作中用 AI 做过哪些类型的任务？（可多选） <span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="A"> A. 代码片段/脚本建议（SAS/R/Python）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="B"> B. 数据清洗/转换/映射（如 SDTM/ADaM 辅助）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="C"> C. 生成统计分析思路/表图（TLF）草案</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="D"> D. 文档生成/润色（SAP、程序注释、审计说明）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="E"> E. 自动化工作流/工具集成（API、LangChain、自建 Agent）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="F"> F. 内部知识库/RAG（如 SOP/模板/最佳实践检索）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="G"> G. 模型微调/本地化部署/私有化</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="H"> H. 风险与合规评估/代码校验辅助</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="I"> <span>I. 其他：</span> <input type="text" name="S6-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>
      </div>

      <!-- B. 基本信息 -->
      <div id="blockB" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">B. 基本信息（B）</h2>

        <div>
          <label class="font-medium">B2 您的主要岗位级别</label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-1">
            <label><input type="radio" name="B2" value="A" required> A. 初级/助理</label>
            <label><input type="radio" name="B2" value="B"> B. 中级/资深</label>
            <label><input type="radio" name="B2" value="C"> C. 主管/组长</label>
            <label><input type="radio" name="B2" value="D"> D. 经理/负责人</label>
            <label><input type="radio" name="B2" value="E"> E. 总监及以上</label>
          </div>
        </div>

        <div>
          <label class="font-medium">B3 您的行业从业年限</label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-1">
            <label><input type="radio" name="B3" value="A" required> A. 0–2 年</label>
            <label><input type="radio" name="B3" value="B"> B. 3–5 年</label>
            <label><input type="radio" name="B3" value="C"> C. 6–9 年</label>
            <label><input type="radio" name="B3" value="D"> D. 10–14 年</label>
            <label><input type="radio" name="B3" value="E"> E. 15 年及以上</label>
          </div>
        </div>

        <div>
          <label class="font-medium">B4 您常用的编程语言/工具（可多选）</label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-1">
            <label><input type="checkbox" name="B4" value="A"> A. SAS</label>
            <label><input type="checkbox" name="B4" value="B"> B. R</label>
            <label><input type="checkbox" name="B4" value="C"> C. Python</label>
            <label><input type="checkbox" name="B4" value="D"> D. SQL</label>
            <label><input type="checkbox" name="B4" value="E"> E. Julia</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="B4" value="F"> <span>F. 其他：</span><input type="text" name="B4-OTHER" class="border rounded px-2 py-1 text-sm flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <div>
          <label class="font-medium">B5 您当前主要涉及的治疗领域（就当前项目为主）</label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-1">
            <label><input type="radio" name="B5" value="A" required> A. 肿瘤</label>
            <label><input type="radio" name="B5" value="B"> B. 免疫</label>
            <label><input type="radio" name="B5" value="C"> C. 代谢</label>
            <label><input type="radio" name="B5" value="D"> D. 心血管</label>
            <label><input type="radio" name="B5" value="E"> E. 神经</label>
            <label><input type="radio" name="B5" value="F"> F. 感染</label>
            <label><input type="radio" name="B5" value="G"> G. 罕见病</label>
            <label><input type="radio" name="B5" value="H"> H. 其他/不固定</label>
          </div>
        </div>
      </div>

      <!-- C. AI 使用情况 -->
      <div id="blockC" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">C. AI 使用情况（2023–2025 年对比）</h2>

        <!-- C1 矩阵单选 -->
        <div>
          <label class="font-medium">C1 您在工作中使用 AI 的频率（各年份）</label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">年份</th>
                <th>从不</th>
                <th>很少（季度）</th>
                <th>偶尔（月）</th>
                <th>经常（周）</th>
                <th>频繁（几乎每天）</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">2023 年</td>
                <td><input type="radio" name="C1_2023" value="从不"></td>
                <td><input type="radio" name="C1_2023" value="很少（季度）"></td>
                <td><input type="radio" name="C1_2023" value="偶尔（月）"></td>
                <td><input type="radio" name="C1_2023" value="经常（周）"></td>
                <td><input type="radio" name="C1_2023" value="频繁（几乎每天）"></td>
              </tr>
              <tr>
                <td class="font-medium">2024 年</td>
                <td><input type="radio" name="C1_2024" value="从不"></td>
                <td><input type="radio" name="C1_2024" value="很少（季度）"></td>
                <td><input type="radio" name="C1_2024" value="偶尔（月）"></td>
                <td><input type="radio" name="C1_2024" value="经常（周）"></td>
                <td><input type="radio" name="C1_2024" value="频繁（几乎每天）"></td>
              </tr>
              <tr>
                <td class="font-medium">2025 年（至今）</td>
                <td><input type="radio" name="C1_2025" value="从不"></td>
                <td><input type="radio" name="C1_2025" value="很少（季度）"></td>
                <td><input type="radio" name="C1_2025" value="偶尔（月）"></td>
                <td><input type="radio" name="C1_2025" value="经常（周）"></td>
                <td><input type="radio" name="C1_2025" value="频繁（几乎每天）"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C2 矩阵多选 -->
        <div>
          <label class="font-medium">C2 您在各年份主要使用 AI 的场景（可多选）</label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">场景</th>
                <th>2023 年</th>
                <th>2024 年</th>
                <th>2025 年</th>
              </tr>
            </thead>
            <tbody id="C2TableBody">
              <tr>
                <td class="font-medium">代码生成/补全</td>
                <td><input type="checkbox" name="C2_代码生成/补全_2023"></td>
                <td><input type="checkbox" name="C2_代码生成/补全_2024"></td>
                <td><input type="checkbox" name="C2_代码生成/补全_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">数据清洗/映射</td>
                <td><input type="checkbox" name="C2_数据清洗/映射_2023"></td>
                <td><input type="checkbox" name="C2_数据清洗/映射_2024"></td>
                <td><input type="checkbox" name="C2_数据清洗/映射_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">统计分析/方法建议</td>
                <td><input type="checkbox" name="C2_统计分析/方法建议_2023"></td>
                <td><input type="checkbox" name="C2_统计分析/方法建议_2024"></td>
                <td><input type="checkbox" name="C2_统计分析/方法建议_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">TLF 生成辅助</td>
                <td><input type="checkbox" name="C2_TLF生成辅助_2023"></td>
                <td><input type="checkbox" name="C2_TLF生成辅助_2024"></td>
                <td><input type="checkbox" name="C2_TLF生成辅助_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">文档撰写/审阅</td>
                <td><input type="checkbox" name="C2_文档撰写/审阅_2023"></td>
                <td><input type="checkbox" name="C2_文档撰写/审阅_2024"></td>
                <td><input type="checkbox" name="C2_文档撰写/审阅_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">知识库检索/RAG</td>
                <td><input type="checkbox" name="C2_知识库检索/RAG_2023"></td>
                <td><input type="checkbox" name="C2_知识库检索/RAG_2024"></td>
                <td><input type="checkbox" name="C2_知识库检索/RAG_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">自动化工作流</td>
                <td><input type="checkbox" name="C2_自动化工作流_2023"></td>
                <td><input type="checkbox" name="C2_自动化工作流_2024"></td>
                <td><input type="checkbox" name="C2_自动化工作流_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">合规/风险评估</td>
                <td><input type="checkbox" name="C2_合规/风险评估_2023"></td>
                <td><input type="checkbox" name="C2_合规/风险评估_2024"></td>
                <td><input type="checkbox" name="C2_合规/风险评估_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">其他</td>
                <td><input type="checkbox" name="C2_其他_2023"></td>
                <td><input type="checkbox" name="C2_其他_2024"></td>
                <td><input type="checkbox" name="C2_其他_2025"></td>
              </tr>
            </tbody>
          </table>
          <div class="mt-2">
            <label class="text-sm">C2-OTHER 如选择"其他"，请填写具体场景：</label>
            <input type="text" name="C2-OTHER" class="border rounded px-2 py-1 text-sm w-full mt-1" placeholder="请填写'其他'的具体场景">
          </div>
        </div>

        <!-- C3 矩阵单选 -->
        <div>
          <label class="font-medium">C3 您自评在各年份因 AI 带来的效率提升幅度</label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">年份</th>
                <th>&lt;10%（含0%）</th>
                <th>10–30%</th>
                <th>30–50%</th>
                <th>50–100%</th>
                <th>&gt;100%</th>
                <th>不好说/未评估</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">2023 年</td>
                <td><input type="radio" name="C3_2023" value="<10%（含0%）"></td>
                <td><input type="radio" name="C3_2023" value="10–30%"></td>
                <td><input type="radio" name="C3_2023" value="30–50%"></td>
                <td><input type="radio" name="C3_2023" value="50–100%"></td>
                <td><input type="radio" name="C3_2023" value=">100%"></td>
                <td><input type="radio" name="C3_2023" value="不好说/未评估"></td>
              </tr>
              <tr>
                <td class="font-medium">2024 年</td>
                <td><input type="radio" name="C3_2024" value="<10%（含0%）"></td>
                <td><input type="radio" name="C3_2024" value="10–30%"></td>
                <td><input type="radio" name="C3_2024" value="30–50%"></td>
                <td><input type="radio" name="C3_2024" value="50–100%"></td>
                <td><input type="radio" name="C3_2024" value=">100%"></td>
                <td><input type="radio" name="C3_2024" value="不好说/未评估"></td>
              </tr>
              <tr>
                <td class="font-medium">2025 年</td>
                <td><input type="radio" name="C3_2025" value="<10%（含0%）"></td>
                <td><input type="radio" name="C3_2025" value="10–30%"></td>
                <td><input type="radio" name="C3_2025" value="30–50%"></td>
                <td><input type="radio" name="C3_2025" value="50–100%"></td>
                <td><input type="radio" name="C3_2025" value=">100%"></td>
                <td><input type="radio" name="C3_2025" value="不好说/未评估"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C4 矩阵单选 -->
        <div>
          <label class="font-medium">C4 您的团队/组织是否有 AI 使用政策（各年份）</label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">年份</th>
                <th>无政策</th>
                <th>有非正式指南</th>
                <th>有正式政策但不强制</th>
                <th>有正式且强制政策</th>
                <th>不清楚</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">2023 年</td>
                <td><input type="radio" name="C4_2023" value="无政策"></td>
                <td><input type="radio" name="C4_2023" value="有非正式指南"></td>
                <td><input type="radio" name="C4_2023" value="有正式政策但不强制"></td>
                <td><input type="radio" name="C4_2023" value="有正式且强制政策"></td>
                <td><input type="radio" name="C4_2023" value="不清楚"></td>
              </tr>
              <tr>
                <td class="font-medium">2024 年</td>
                <td><input type="radio" name="C4_2024" value="无政策"></td>
                <td><input type="radio" name="C4_2024" value="有非正式指南"></td>
                <td><input type="radio" name="C4_2024" value="有正式政策但不强制"></td>
                <td><input type="radio" name="C4_2024" value="有正式且强制政策"></td>
                <td><input type="radio" name="C4_2024" value="不清楚"></td>
              </tr>
              <tr>
                <td class="font-medium">2025 年</td>
                <td><input type="radio" name="C4_2025" value="无政策"></td>
                <td><input type="radio" name="C4_2025" value="有非正式指南"></td>
                <td><input type="radio" name="C4_2025" value="有正式政策但不强制"></td>
                <td><input type="radio" name="C4_2025" value="有正式且强制政策"></td>
                <td><input type="radio" name="C4_2025" value="不清楚"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C5 多选，每行一个 -->
        <div>
          <label class="font-medium">C5 您在 2025 年常用的 AI/模型或平台（可多选）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="A"> A. ChatGPT 系列</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="B"> B. Claude</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="C"> C. Gemini</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="D"> D. DeepSeek</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="E"> E. Copilot（SAS/R/Python/VS Code 等）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="F"> F. 国产大模型（阿里/百度/字节/华为等）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="G"> G. 私有化/本地 LLM</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="H"> H. 公司自研工具</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="I"> I. 不了解/未关注</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="J"> J. 不方便透露</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="K"> <span>K. 其他：</span><input type="text" name="C5-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- C6 单选，每行一个 -->
        <div>
          <label class="font-medium">C6 您在 2025 年用于处理含敏感数据（如患者级数据/受控文档）的做法</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="A"> A. 从不在 AI 工具中输入敏感数据</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="B"> B. 仅在公司批准的安全环境中使用（如私有化、脱敏）</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="C"> C. 公司 AI 工具会自动屏蔽/脱敏敏感信息，我不作额外处理直接上传</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="D"> D. 在公开云工具中谨慎使用（删除标识/片段化）</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="E"> E. 不清楚/未关注</label>
          </div>
        </div>

        <!-- C8 开放题 -->
        <div>
          <label class="font-medium">C8 请举例说明 AI 为您节省的一个典型任务或带来的限制：</label>
          <textarea name="C8" rows="3" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="可选填写"></textarea>
        </div>

        <!-- C-ATTN 注意力校验题 -->
        <div class="border rounded p-3">
          <label class="font-medium">C-ATTN 注意力校验题（为通过校验，请选择"偶尔（月）"）</label>
          <div class="mt-2 space-y-1">
            <label><input type="radio" name="C-ATTN" value="A"> A. 从不</label>
            <label><input type="radio" name="C-ATTN" value="B"> B. 很少（季度）</label>
            <label><input type="radio" name="C-ATTN" value="C"> C. 偶尔（月）</label>
            <label><input type="radio" name="C-ATTN" value="D"> D. 经常（周）</label>
            <label><input type="radio" name="C-ATTN" value="E"> E. 频繁（几乎每天）</label>
          </div>
          <p id="attnWarn" class="text-sm text-amber-600 mt-2 hidden">提示：注意力校验未通过。可返回修改为"偶尔（月）"。即使不修改也允许提交。</p>
        </div>
      </div>

      <!-- D. 态度 -->
      <div id="blockD" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">D. 对 AI 的态度（2023–2025 年对比）</h2>

        <div>
          <label class="font-medium">D1 您对以下陈述在各年份的看法</label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">陈述/年份</th>
                <th>非常不同意</th>
                <th>不同意</th>
                <th>中立</th>
                <th>同意</th>
                <th>非常同意</th>
              </tr>
            </thead>
            <tbody>
              <!-- AI 提升统计编程效率 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 提升统计编程效率</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_1" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_1" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_1" value="中立"></td>
                <td><input type="radio" name="D1_2023年_1" value="同意"></td>
                <td><input type="radio" name="D1_2023年_1" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_1" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_1" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_1" value="中立"></td>
                <td><input type="radio" name="D1_2024年_1" value="同意"></td>
                <td><input type="radio" name="D1_2024年_1" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_1" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_1" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_1" value="中立"></td>
                <td><input type="radio" name="D1_2025年_1" value="同意"></td>
                <td><input type="radio" name="D1_2025年_1" value="非常同意"></td>
              </tr>

              <!-- AI 有助于减少低级错误 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 有助于减少低级错误</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_2" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_2" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_2" value="中立"></td>
                <td><input type="radio" name="D1_2023年_2" value="同意"></td>
                <td><input type="radio" name="D1_2023年_2" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_2" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_2" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_2" value="中立"></td>
                <td><input type="radio" name="D1_2024年_2" value="同意"></td>
                <td><input type="radio" name="D1_2024年_2" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_2" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_2" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_2" value="中立"></td>
                <td><input type="radio" name="D1_2025年_2" value="同意"></td>
                <td><input type="radio" name="D1_2025年_2" value="非常同意"></td>
              </tr>

              <!-- AI 增加合规/审计风险（反向） -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 增加合规/审计风险（反向）</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_3" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_3" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_3" value="中立"></td>
                <td><input type="radio" name="D1_2023年_3" value="同意"></td>
                <td><input type="radio" name="D1_2023年_3" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_3" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_3" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_3" value="中立"></td>
                <td><input type="radio" name="D1_2024年_3" value="同意"></td>
                <td><input type="radio" name="D1_2024年_3" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_3" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_3" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_3" value="中立"></td>
                <td><input type="radio" name="D1_2025年_3" value="同意"></td>
                <td><input type="radio" name="D1_2025年_3" value="非常同意"></td>
              </tr>

              <!-- AI 对初级岗位替代风险高（反向） -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 对初级岗位替代风险高（反向）</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_4" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_4" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_4" value="中立"></td>
                <td><input type="radio" name="D1_2023年_4" value="同意"></td>
                <td><input type="radio" name="D1_2023年_4" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_4" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_4" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_4" value="中立"></td>
                <td><input type="radio" name="D1_2024年_4" value="同意"></td>
                <td><input type="radio" name="D1_2024年_4" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_4" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_4" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_4" value="中立"></td>
                <td><input type="radio" name="D1_2025年_4" value="同意"></td>
                <td><input type="radio" name="D1_2025年_4" value="非常同意"></td>
              </tr>

              <!-- AI 有助于学习与知识传承 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 有助于学习与知识传承</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_5" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_5" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_5" value="中立"></td>
                <td><input type="radio" name="D1_2023年_5" value="同意"></td>
                <td><input type="radio" name="D1_2023年_5" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_5" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_5" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_5" value="中立"></td>
                <td><input type="radio" name="D1_2024年_5" value="同意"></td>
                <td><input type="radio" name="D1_2024年_5" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_5" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_5" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_5" value="中立"></td>
                <td><input type="radio" name="D1_2025年_5" value="同意"></td>
                <td><input type="radio" name="D1_2025年_5" value="非常同意"></td>
              </tr>

              <!-- AI 适合用于注册申报交付环节 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 适合用于注册申报交付环节</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_6" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_6" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_6" value="中立"></td>
                <td><input type="radio" name="D1_2023年_6" value="同意"></td>
                <td><input type="radio" name="D1_2023年_6" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_6" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_6" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_6" value="中立"></td>
                <td><input type="radio" name="D1_2024年_6" value="同意"></td>
                <td><input type="radio" name="D1_2024年_6" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_6" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_6" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_6" value="中立"></td>
                <td><input type="radio" name="D1_2025年_6" value="同意"></td>
                <td><input type="radio" name="D1_2025年_6" value="非常同意"></td>
              </tr>

              <!-- AI 的输出需要严格的人审/双编 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 的输出需要严格的人审/双编</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_7" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_7" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_7" value="中立"></td>
                <td><input type="radio" name="D1_2023年_7" value="同意"></td>
                <td><input type="radio" name="D1_2023年_7" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_7" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_7" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_7" value="中立"></td>
                <td><input type="radio" name="D1_2024年_7" value="同意"></td>
                <td><input type="radio" name="D1_2024年_7" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_7" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_7" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_7" value="中立"></td>
                <td><input type="radio" name="D1_2025年_7" value="同意"></td>
                <td><input type="radio" name="D1_2025年_7" value="非常同意"></td>
              </tr>

              <!-- 我对 AI 在专业场景下的可信度更高 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">我对 AI 在专业场景下的可信度更高</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_8" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_8" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_8" value="中立"></td>
                <td><input type="radio" name="D1_2023年_8" value="同意"></td>
                <td><input type="radio" name="D1_2023年_8" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_8" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_8" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_8" value="中立"></td>
                <td><input type="radio" name="D1_2024年_8" value="同意"></td>
                <td><input type="radio" name="D1_2024年_8" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_8" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_8" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_8" value="中立"></td>
                <td><input type="radio" name="D1_2025年_8" value="同意"></td>
                <td><input type="radio" name="D1_2025年_8" value="非常同意"></td>
              </tr>

              <!-- 我乐于向团队推广 AI 最佳实践 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">我乐于向团队推广 AI 最佳实践</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_9" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_9" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_9" value="中立"></td>
                <td><input type="radio" name="D1_2023年_9" value="同意"></td>
                <td><input type="radio" name="D1_2023年_9" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_9" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_9" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_9" value="中立"></td>
                <td><input type="radio" name="D1_2024年_9" value="同意"></td>
                <td><input type="radio" name="D1_2024年_9" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_9" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_9" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_9" value="中立"></td>
                <td><input type="radio" name="D1_2025年_9" value="同意"></td>
                <td><input type="radio" name="D1_2025年_9" value="非常同意"></td>
              </tr>

              <!-- 公司应加大 AI 培训与投入 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">公司应加大 AI 培训与投入</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_10" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_10" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_10" value="中立"></td>
                <td><input type="radio" name="D1_2023年_10" value="同意"></td>
                <td><input type="radio" name="D1_2023年_10" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_10" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_10" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_10" value="中立"></td>
                <td><input type="radio" name="D1_2024年_10" value="同意"></td>
                <td><input type="radio" name="D1_2024年_10" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_10" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_10" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_10" value="中立"></td>
                <td><input type="radio" name="D1_2025年_10" value="同意"></td>
                <td><input type="radio" name="D1_2025年_10" value="非常同意"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- D2 单选题 -->
        <div>
          <label class="font-medium">D2 您预计未来 1 年 AI 在统计编程行业的影响（单选）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="A"> A. 进一步增强生产力，形成行业刚需</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="B"> B. 有助提升，但影响有限</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="C"> C. 与现有工具类似，不会显著改变行业</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="D"> D. 可能带来负面影响（如技能退化、过度依赖）</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="E"> E. 不确定/难以预测</label>
          </div>
        </div>

        <!-- D3 多选题 -->
        <div>
          <label class="font-medium">D3 您认为哪些因素最制约 AI 在统计编程中的应用？（可多选，最多3项）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="A"> A. 数据安全与隐私合规风险</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="B"> B. AI输出的准确性与可信度不足</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="C"> C. 缺乏针对性的AI工具与平台</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="D"> D. 公司政策限制或缺乏明确指导</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="E"> E. 团队技能与培训不足</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="F"> F. 成本考虑（license、计算资源等）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="G"> G. 审计追踪与可重现性要求</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="H"> H. 监管部门对AI使用的不确定态度</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="I"> <span>I. 其他：</span><input type="text" name="D3-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- D4 单选题 -->
        <div>
          <label class="font-medium">D4 您倾向于在哪些情境下更信任 AI 的建议？（单选）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="A"> A. 重复性高、标准化的编程任务</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="B"> B. 有明确业务逻辑、可校验的分析</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="C"> C. 初期探索、获取灵感的阶段</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="D"> D. 有充足时间进行验证的项目</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="E"> E. 都不信任，仅作参考</label>
          </div>
        </div>
      </div>

      <!-- E. 展望与建议 -->
      <div id="blockE" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">E. 展望与建议（E）</h2>

        <!-- E1 多选题 -->
        <div>
          <label class="font-medium">E1 您认为最需要 AI 改进的统计编程环节（可多选，最多3项）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="A"> A. 代码生成与优化（提高代码质量与效率）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="B"> B. 数据清洗与转换的自动化</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="C"> C. 质量控制与校验（QC自动化）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="D"> D. 技术文档生成与维护</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="E"> E. 知识管理与最佳实践检索</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="F"> F. 合规性检查与风险评估</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="G"> G. 培训与技能提升辅助</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="H"> <span>H. 其他：</span><input type="text" name="E1-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- E2 单选题 -->
        <div>
          <label class="font-medium">E2 您对公司 AI 政策的建议（单选）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="A"> A. 制定更明确的使用指南与边界</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="B"> B. 加大 AI 工具与基础设施投入</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="C"> C. 增加相关培训与能力建设</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="D"> D. 建立最佳实践分享与交流机制</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="E"> E. 保持现状，观望发展</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="F"> F. 更谨慎使用，加强风险控制</label>
          </div>
        </div>

        <!-- E3 开放题 -->
        <div>
          <label class="font-medium">E3 如果让您向同行推荐，您会如何描述 AI 在统计编程中的价值？</label>
          <textarea name="E3" rows="3" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="可选填写，如'AI帮我提升了...，但需要注意...'"></textarea>
        </div>

        <!-- E4 排序题 -->
        <div>
          <label class="font-medium">E4 以下哪个 AI 发展方向对您最有吸引力？（按优先级排序，1-5，1最重要）</label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><span class="w-64">更准确的领域专用模型</span><select name="E4_A" class="border rounded px-2 py-1"><option value="">请选择</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></label>
            <label class="flex items-center gap-2"><span class="w-64">更强的代码理解与生成能力</span><select name="E4_B" class="border rounded px-2 py-1"><option value="">请选择</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></label>
            <label class="flex items-center gap-2"><span class="w-64">更好的安全性与隐私保护</span><select name="E4_C" class="border rounded px-2 py-1"><option value="">请选择</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></label>
            <label class="flex items-center gap-2"><span class="w-64">更便宜的使用成本</span><select name="E4_D" class="border rounded px-2 py-1"><option value="">请选择</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></label>
            <label class="flex items-center gap-2"><span class="w-64">更完善的生态与工具集成</span><select name="E4_E" class="border rounded px-2 py-1"><option value="">请选择</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></label>
          </div>
        </div>
      </div>

      <!-- F. 开放反馈 -->
      <div id="blockF" class="bg-white rounded border p-5 space-y-4">
        <h2 class="text-xl font-semibold">F. 开放反馈（F）</h2>
        
        <div>
          <label class="font-medium">F1 您对本次调研或 AI 在统计编程领域的其他建议：</label>
          <textarea name="F1" rows="4" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="可选填写您的任何建议、意见或补充..."></textarea>
        </div>

        <div>
          <label class="font-medium">F2 如果有机会，您是否愿意参与后续的深度访谈或案例分享？</label>
          <div class="mt-2 space-y-1">
            <label><input type="radio" name="F2" value="A"> A. 愿意，可提供联系方式</label>
            <label><input type="radio" name="F2" value="B"> B. 有兴趣，但需要了解更多详情</label>
            <label><input type="radio" name="F2" value="C"> C. 暂时不考虑</label>
          </div>
          <div id="F2_contact" class="mt-2 hidden">
            <input type="email" name="F2_CONTACT" class="border rounded px-2 py-1 text-sm w-full" placeholder="如愿意参与，可选择填写邮箱（不会用于其他目的）">
            <p class="text-xs text-gray-500 mt-1">仅用于后续学术交流，不会用于营销或其他商业目的</p>
          </div>
        </div>
      </div>

      <!-- 提交区域 -->
      <div class="bg-white rounded border p-5">
        <div class="flex gap-4 items-center flex-wrap">
          <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">提交问卷</button>
          <button type="button" id="exportBtn" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors">导出数据</button>
          <button type="button" id="previewBtn" class="px-6 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors">预览答案</button>
          <span class="text-sm text-gray-500">提交前请检查必填项是否完整</span>
        </div>
        
        <div class="mt-4 text-xs text-gray-500">
          <p>* 问卷数据将用于学术研究，不会泄露个人隐私信息</p>
          <p>* 如有疑问，可通过问卷末尾的联系方式反馈</p>
        </div>
      </div>
    </form>

    <!-- 提交成功提示 -->
    <div id="submitSuccess" class="hidden bg-green-50 border border-green-200 rounded p-4 mt-4">
      <h3 class="font-semibold text-green-800">🎉 提交成功！</h3>
      <p class="text-green-700 mt-1">感谢您的参与！您的回答对了解 AI 在统计编程行业的应用现状非常有价值。</p>
      <div class="mt-3 text-sm text-green-600">
        <p>• 预计问卷收集将持续2-4周</p>
        <p>• 结果分析完成后会通过适当渠道分享</p>
        <p>• 如您留下联系方式，我们会优先向您反馈结果</p>
      </div>
    </div>

    <!-- 预览弹窗 -->
    <div id="previewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
      <div class="bg-white rounded-lg p-6 max-w-2xl max-h-96 overflow-y-auto m-4">
        <h3 class="font-bold text-lg mb-4">答案预览</h3>
        <div id="previewContent" class="text-sm space-y-2"></div>
        <div class="mt-4 flex gap-2">
          <button id="closePreview" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">关闭</button>
          <button id="downloadPreview" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">下载预览</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 完整的交互脚本
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('surveyForm');
      const submitSuccess = document.getElementById('submitSuccess');
      const previewModal = document.getElementById('previewModal');
      
      // 自动保存功能
      const inputs = form.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
        input.addEventListener('change', function() {
          localStorage.setItem('survey_' + this.name, this.value);
          if (this.type === 'checkbox') {
            localStorage.setItem('survey_' + this.name + '_checked', this.checked);
          }
        });
      });
      
      // 加载保存的数据
      inputs.forEach(input => {
        const saved = localStorage.getItem('survey_' + input.name);
        if (saved) {
          if (input.type === 'checkbox') {
            const checkedSaved = localStorage.getItem('survey_' + input.name + '_checked');
            if (checkedSaved === 'true') input.checked = true;
          } else if (input.type === 'radio') {
            if (input.value === saved) input.checked = true;
          } else {
            input.value = saved;
          }
        }
      });
      
      // S1 逻辑 - 选择"否"时显示结束消息
      const s1Inputs = document.querySelectorAll('input[name="S1"]');
      s1Inputs.forEach(input => {
        input.addEventListener('change', function() {
          const endMsg = document.getElementById('endMsgS1');
          if (this.value === 'B' && this.checked) {
            endMsg.classList.remove('hidden');
          } else {
            endMsg.classList.add('hidden');
          }
        });
      });
      
      // 多选框"其他"选项的文本框联动
      const otherCheckboxes = document.querySelectorAll('input[type="checkbox"][value*="其他"], input[type="checkbox"][value="K"], input[type="checkbox"][value="I"]');
      otherCheckboxes.forEach(checkbox => {
        const textInput = checkbox.parentElement.querySelector('input[type="text"]');
        if (textInput) {
          checkbox.addEventListener('change', function() {
            textInput.disabled = !this.checked;
            if (!this.checked) textInput.value = '';
          });
        }
      });
      
      // F2 联系方式显示逻辑
      const f2Inputs = document.querySelectorAll('input[name="F2"]');
      const f2Contact = document.getElementById('F2_contact');
      f2Inputs.forEach(input => {
        input.addEventListener('change', function() {
          if (this.value === 'A' && this.checked) {
            f2Contact.classList.remove('hidden');
          } else {
            f2Contact.classList.add('hidden');
          }
        });
      });
      
      // 注意力校验
      const attnInputs = document.querySelectorAll('input[name="C-ATTN"]');
      const attnWarn = document.getElementById('attnWarn');
      if (attnInputs.length > 0 && attnWarn) {
        attnInputs.forEach(input => {
          input.addEventListener('change', function() {
            if (this.value === 'C' && this.checked) {
              attnWarn.classList.add('hidden');
            } else if (this.checked) {
              attnWarn.classList.remove('hidden');
            }
          });
        });
      }
      
      // 重置按钮
      document.getElementById('resetBtn').addEventListener('click', function() {
        if (confirm('确定要重置所有答案吗？这将清除已保存的所有数据。')) {
          form.reset();
          // 清除本地存储
          Object.keys(localStorage).forEach(key => {
            if (key.startsWith('survey_')) {
              localStorage.removeItem(key);
            }
          });
          // 隐藏所有动态显示的元素
          document.querySelectorAll('.hidden').forEach(el => el.classList.add('hidden'));
        }
      });
      
      // 导出数据功能
      document.getElementById('exportBtn').addEventListener('click', function() {
        const formData = new FormData(form);
        const data = {};
        
        // 处理多选题
        for (let [key, value] of formData.entries()) {
          if (data[key]) {
            if (Array.isArray(data[key])) {
              data[key].push(value);
            } else {
              data[key] = [data[key], value];
            }
          } else {
            data[key] = value;
          }
        }
        
        // 添加时间戳
        data._timestamp = new Date().toISOString();
        data._version = "2025.1";
        
        const jsonData = JSON.stringify(data, null, 2);
        const blob = new Blob([jsonData], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = 'ai_survey_data_' + new Date().toISOString().slice(0, 10) + '.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        alert('数据已导出到文件！');
      });
      
      // 预览功能
      document.getElementById('previewBtn').addEventListener('click', function() {
        const formData = new FormData(form);
        const previewContent = document.getElementById('previewContent');
        let html = '';
        
        for (let [key, value] of formData.entries()) {
          if (value.trim()) {
            html += `<div><strong>${key}:</strong> ${value}</div>`;
          }
        }
        
        if (!html) {
          html = '<div class="text-gray-500">暂无填写内容</div>';
        }
        
        previewContent.innerHTML = html;
        previewModal.classList.remove('hidden');
      });
      
      // 关闭预览
      document.getElementById('closePreview').addEventListener('click', function() {
        previewModal.classList.add('hidden');
      });
      
      // 表单提交处理
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // 基本验证
        const requiredFields = form.querySelectorAll('[required]');
        let valid = true;
        let missingFields = [];
        
        requiredFields.forEach(field => {
          let fieldValid = false;
          
          if (field.type === 'radio') {
            fieldValid = form.querySelector(`input[name="${field.name}"]:checked`) !== null;
          } else if (field.type === 'checkbox') {
            // 对于必填的多选组，检查是否至少选择了一个
            const checkboxGroup = form.querySelectorAll(`input[name="${field.name}"]`);
            fieldValid = Array.from(checkboxGroup).some(cb => cb.checked);
          } else {
            fieldValid = field.value.trim() !== '';
          }
          
          if (!fieldValid) {
            valid = false;
            missingFields.push(field.name);
            field.style.borderColor = '#ef4444';
          } else {
            field.style.borderColor = '';
          }
        });
        
        if (!valid) {
          alert('请完成以下必填项：' + missingFields.join(', '));
          // 滚动到第一个未填写的必填项
          const firstMissing = form.querySelector(`[name="${missingFields[0]}"]`);
          if (firstMissing) {
            firstMissing.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
          return;
        }
        
        // 显示成功消息
        submitSuccess.classList.remove('hidden');
        form.style.display = 'none';
        
        // 滚动到成功消息
        submitSuccess.scrollIntoView({ behavior: 'smooth' });
        
        // 清除本地存储（可选）
        // localStorage.clear();
      });
      
      // 点击模态框外部关闭
      previewModal.addEventListener('click', function(e) {
        if (e.target === previewModal) {
          previewModal.classList.add('hidden');
        }
      });
    });
  </script>
</body>
</html>
