
<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>中国药物研发统计编程行业 AI 应用演变与展望调研（2023-2025）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <meta name="color-scheme" content="light" />
  <style>
    /* 基础样式优化 */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    /* 主容器样式 */
    .main-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      margin: 2rem auto;
    }
    
    /* 卡片样式 */
    .section-card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s ease;
      overflow: hidden;
    }
    
    .section-card:hover {
      transform: translateY(-2px);
    }
    
    /* 标题样式 */
    .section-title {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      padding: 1.5rem 2rem;
      font-size: 1.25rem;
      font-weight: 600;
      color: #1e293b;
      margin: 0;
    }
    
    /* 表单控件 */
    input[type="radio"], input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: #4f46e5;
    }
    
    input[type="text"], input[type="email"], textarea, select {
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 0.75rem;
      transition: all 0.2s ease;
    }
    
    input[type="text"]:focus, input[type="email"]:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #4f46e5;
      box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    }
    
    /* 标签样式 */
    label {
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 8px;
      transition: background-color 0.2s ease;
    }
    
    label:hover {
      background-color: #f8fafc;
    }
    
    /* 矩阵表格 */
    .matrix {
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    
    .matrix th, .matrix td {
      border: 1px solid #e2e8f0;
      padding: 12px;
      background: white;
    }
    
    .matrix th {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      font-weight: 600;
      color: #334155;
    }
    
    .matrix td { text-align: center; }
    .matrix th:first-child, .matrix td:first-child { text-align: left !important; }
    
    .matrix tr:hover td {
      background-color: #f8fafc;
    }
    
    /* 按钮样式 */
    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 10px;
      font-weight: 600;
      transition: all 0.2s ease;
      border: none;
      cursor: pointer;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
    }
    
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
    }
    
    /* 其他样式 */
    .hidden-important { display: none !important; }
    .indent-row { padding-left: 2rem !important; }
    .required-star { color: #ef4444; font-weight: bold; }
    
    /* 拖拽排序样式 */
    .sortable-item {
      transition: all 0.2s ease;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }
    .sortable-item:hover, .sortable-item:active {
      background-color: #f3f4f6;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .sortable-item.dragging {
      opacity: 0.5;
      transform: rotate(2deg);
      z-index: 1000;
    }
    
    /* 移动端优化 */
    @media (max-width: 768px) {
      .sortable-item {
        padding: 1rem;
        margin-bottom: 0.5rem;
      }
      .drag-handle {
        font-size: 1.2rem;
      }
    }
    
    /* 响应式 */
    @media (max-width: 768px) {
      .main-container {
        margin: 1rem;
        border-radius: 16px;
      }
      
      .matrix {
        font-size: 0.65rem;
        width: 100%;
        table-layout: fixed;
      }
      
      .matrix th, .matrix td {
        padding: 4px 1px;
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
      }
      
      .matrix th:first-child, .matrix td:first-child {
        width: 35%;
      }
      
      .matrix th:not(:first-child), .matrix td:not(:first-child) {
        width: 13%;
      }
      
      footer {
        border-radius: 0 0 16px 16px;
      }
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <div class="max-w-5xl main-container">
    <header class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-8 text-center">
      <h1 class="text-3xl font-bold mb-4">中国药物研发统计编程行业 AI 应用演变与展望调研（2023-2025）</h1>


    </header>
    
    <div class="p-6">

    <section class="mb-6">
      <div class="bg-white p-6 rounded-lg border shadow-sm">
        <h3 class="font-semibold text-lg mb-4">填写说明</h3>
        <div class="text-sm text-gray-700 space-y-4">
          <div class="flex items-start gap-3">
            <span class="text-lg">⏱️</span>
            <div>
              <strong>预计填写时间：5-10分钟</strong>
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <span class="text-lg">📢</span>
            <div>
              <strong>调研结果将于2025年11月7日在 PHUSE SDE 活动中线下和线上同时公布</strong>
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <span class="text-lg">🔒</span>
            <div>
              <strong>完全匿名调研</strong><br>
              本问卷不收集任何个人身份信息或公司信息，所有数据仅用于行业趋势分析。
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <span class="text-lg">🤖</span>
            <div>
              <strong>AI 定义</strong><br>
              本问卷中的"AI"特指生成式 AI/大语言模型及其衍生工具（如ChatGPT、Claude、Copilot、代码生成工具等），不包含传统宏/脚本工具。
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <span class="text-lg">📅</span>
            <div>
              <strong>年份口径与背景</strong><br>
              • 2023年（2023.01–12）：生成式AI"元年"，ChatGPT等工具开始普及<br>
              • 2024年（2024.01–12）：AI技术"高速发展"期，各类工具百花齐放<br>
              • 2025年（2025.01–填写当月）：行业"逐步落地"阶段，实际项目应用增多
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <span class="text-lg">🎯</span>
            <div>
              <strong>调研目的</strong><br>
              追踪中国药物研发统计编程行业在AI应用方面的演进轨迹，为行业发展提供数据支撑和趋势洞察。
            </div>
          </div>
        </div>
      </div>
    </section>

    <form id="surveyForm" class="space-y-10">
      <!-- A. 筛选与分支 S -->
      <div id="blockA" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">👤 基本信息</h2>


        <!-- 必填验证提示 -->
        <div id="sSectionValidation" class="bg-red-50 border border-red-200 rounded p-3 text-sm text-red-700 hidden">
          <strong>请完成前面的必填项：</strong>
          <ul id="sMissingItems" class="list-disc list-inside mt-1"></ul>
        </div>

        <!-- S1 -->
        <div>
          <label class="font-bold">您目前的主要工作地点在中国大陆吗？ <span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="S1" value="A" required> <span>是</span></label>
            <label class="flex items-center gap-2"><input type="radio" name="S1" value="B"> <span>否（将结束问卷）</span></label>
          </div>
          <p id="endMsgS1" class="mt-2 text-sm text-red-600 hidden">您选择了"否"，问卷将在此结束。非常感谢您的时间！</p>
        </div>

        <!-- S2 单选 -->
        <div>
          <label class="font-bold">您所在的组织类型（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="A" required> 跨国药企（MNC）在华机构</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="B"> 本土药企（Local）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="C"> CRO/服务外包公司</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="D"> 其他医药相关机构</label>
            <label class="flex items-center gap-2"><input type="radio" name="S2" value="E"> 不方便透露</label>
          </div>
        </div>

        <!-- S3 多选 -->
        <div>
          <label class="font-bold">您近一年在统计编程相关的主要工作内容（多选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="A"> 生成/映射 SDTM</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="B"> 生成 ADaM</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="C"> 生成/校对 TLF（表/图/列表）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="D"> 编程 QC/Validation（含双编、审计追踪）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="E"> Define.xml/ADRGS/数据集说明文档的编程支持</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="F"> 将 SAP/统计方法转化为可运行代码</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="G"> 工具与宏/包开发与维护（SAS/R/Python）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="H"> 自动化流水线/作业编排（如 CI/CD）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="I"> 带人经理（已不参与编程）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="J"> 项目管理（PM/交付协调）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S3" value="K"> <span>其他：</span> <input type="text" name="S3-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- S5 -->
        <div>
          <label class="font-bold">您在 2025 年工作中使用 AI 的频率（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="A" required> 从不</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="B"> 很少（每季度或更少）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="C"> 偶尔（每月）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="D"> 经常（每周）</label>
            <label class="flex items-center gap-2"><input type="radio" name="S5" value="E"> 频繁（几乎每天）</label>
          </div>
        </div>

        <!-- S6 多选，每行一个 -->
        <div>
          <label class="font-bold">您在工作中用 AI 做过哪些类型的任务（多选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="A"> 代码片段/脚本建议（SAS/R/Python）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="B"> 数据清洗/转换/映射（如 SDTM/ADaM 辅助）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="C"> 生成统计分析思路/表图（TLF）草案</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="D"> 文档生成/润色（SAP、程序注释、审计说明）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="E"> 自动化工作流/工具集成（API、LangChain、自建 Agent）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="F"> 内部知识库/RAG（如 SOP/模板/最佳实践检索）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="G"> 模型微调/本地化部署/私有化</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="H"> 风险与合规评估/代码校验辅助</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="S6" value="I"> <span>其他：</span> <input type="text" name="S6-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <div>
          <label class="font-bold">您的主要岗位级别（单选）<span class="required-star">*</span></label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-1">
            <label><input type="radio" name="B2" value="A" required> 初级/助理</label>
            <label><input type="radio" name="B2" value="B"> 中级/资深</label>
            <label><input type="radio" name="B2" value="C"> 主管/组长</label>
            <label><input type="radio" name="B2" value="D"> 经理/负责人</label>
            <label><input type="radio" name="B2" value="E"> 总监及以上</label>
          </div>
        </div>

        <div>
          <label class="font-bold">您的行业从业年限（单选）<span class="required-star">*</span></label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-1">
            <label><input type="radio" name="B3" value="A" required> 0–2 年</label>
            <label><input type="radio" name="B3" value="B"> 3–5 年</label>
            <label><input type="radio" name="B3" value="C"> 6–9 年</label>
            <label><input type="radio" name="B3" value="D"> 10–14 年</label>
            <label><input type="radio" name="B3" value="E"> 15 年及以上</label>
          </div>
        </div>

        <div>
          <label class="font-bold">您常用的编程语言/工具（多选）<span class="required-star">*</span></label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-1">
            <label><input type="checkbox" name="B4" value="A"> SAS</label>
            <label><input type="checkbox" name="B4" value="B"> R</label>
            <label><input type="checkbox" name="B4" value="C"> Python</label>
            <label><input type="checkbox" name="B4" value="D"> SQL</label>
            <label><input type="checkbox" name="B4" value="E"> Julia</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="B4" value="F"> <span>其他：</span><input type="text" name="B4-OTHER" class="border rounded px-2 py-1 text-sm flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <div>
          <label class="font-bold">您当前主要涉及的治疗领域（单选）<span class="required-star">*</span></label>
          <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-1">
            <label><input type="radio" name="B5" value="A" required> 肿瘤</label>
            <label><input type="radio" name="B5" value="B"> 免疫</label>
            <label><input type="radio" name="B5" value="C"> 代谢</label>
            <label><input type="radio" name="B5" value="D"> 心血管</label>
            <label><input type="radio" name="B5" value="E"> 神经</label>
            <label><input type="radio" name="B5" value="F"> 感染</label>
            <label><input type="radio" name="B5" value="G"> 罕见病</label>
            <label><input type="radio" name="B5" value="H"> 其他/不固定</label>
          </div>
      </div>
        </div>
      <!--</div>-->

      <!-- C. AI 使用情况 -->
      <div id="blockC" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">AI 使用情况（2023–2025 年对比）</h2>

        <!-- C1 矩阵单选 -->
        <div>
          <label class="font-bold">您在工作中使用 AI 的频率（矩阵单选）<span class="required-star">*</span></label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">年份</th>
                <th>从不</th>
                <th>很少（季度）</th>
                <th>偶尔（月）</th>
                <th>经常（周）</th>
                <th>频繁（几乎每天）</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">2023 年</td>
                <td><input type="radio" name="C1_2023" value="从不"></td>
                <td><input type="radio" name="C1_2023" value="很少（季度）"></td>
                <td><input type="radio" name="C1_2023" value="偶尔（月）"></td>
                <td><input type="radio" name="C1_2023" value="经常（周）"></td>
                <td><input type="radio" name="C1_2023" value="频繁（几乎每天）"></td>
              </tr>
              <tr>
                <td class="font-medium">2024 年</td>
                <td><input type="radio" name="C1_2024" value="从不"></td>
                <td><input type="radio" name="C1_2024" value="很少（季度）"></td>
                <td><input type="radio" name="C1_2024" value="偶尔（月）"></td>
                <td><input type="radio" name="C1_2024" value="经常（周）"></td>
                <td><input type="radio" name="C1_2024" value="频繁（几乎每天）"></td>
              </tr>
              <tr>
                <td class="font-medium">2025 年（至今）</td>
                <td><input type="radio" name="C1_2025" value="从不"></td>
                <td><input type="radio" name="C1_2025" value="很少（季度）"></td>
                <td><input type="radio" name="C1_2025" value="偶尔（月）"></td>
                <td><input type="radio" name="C1_2025" value="经常（周）"></td>
                <td><input type="radio" name="C1_2025" value="频繁（几乎每天）"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C2 矩阵多选 -->
        <div>
          <label class="font-bold">您在各年份主要使用 AI 的场景（矩阵多选）<span class="required-star">*</span></label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">场景</th>
                <th>2023 年</th>
                <th>2024 年</th>
                <th>2025 年</th>
              </tr>
            </thead>
            <tbody id="C2TableBody">
              <tr>
                <td class="font-medium">代码生成/补全</td>
                <td><input type="checkbox" name="C2_代码生成/补全_2023"></td>
                <td><input type="checkbox" name="C2_代码生成/补全_2024"></td>
                <td><input type="checkbox" name="C2_代码生成/补全_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">数据清洗/映射</td>
                <td><input type="checkbox" name="C2_数据清洗/映射_2023"></td>
                <td><input type="checkbox" name="C2_数据清洗/映射_2024"></td>
                <td><input type="checkbox" name="C2_数据清洗/映射_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">统计分析/方法建议</td>
                <td><input type="checkbox" name="C2_统计分析/方法建议_2023"></td>
                <td><input type="checkbox" name="C2_统计分析/方法建议_2024"></td>
                <td><input type="checkbox" name="C2_统计分析/方法建议_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">TLF 生成辅助</td>
                <td><input type="checkbox" name="C2_TLF生成辅助_2023"></td>
                <td><input type="checkbox" name="C2_TLF生成辅助_2024"></td>
                <td><input type="checkbox" name="C2_TLF生成辅助_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">文档撰写/审阅</td>
                <td><input type="checkbox" name="C2_文档撰写/审阅_2023"></td>
                <td><input type="checkbox" name="C2_文档撰写/审阅_2024"></td>
                <td><input type="checkbox" name="C2_文档撰写/审阅_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">知识库检索/RAG</td>
                <td><input type="checkbox" name="C2_知识库检索/RAG_2023"></td>
                <td><input type="checkbox" name="C2_知识库检索/RAG_2024"></td>
                <td><input type="checkbox" name="C2_知识库检索/RAG_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">自动化工作流</td>
                <td><input type="checkbox" name="C2_自动化工作流_2023"></td>
                <td><input type="checkbox" name="C2_自动化工作流_2024"></td>
                <td><input type="checkbox" name="C2_自动化工作流_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">合规/风险评估</td>
                <td><input type="checkbox" name="C2_合规/风险评估_2023"></td>
                <td><input type="checkbox" name="C2_合规/风险评估_2024"></td>
                <td><input type="checkbox" name="C2_合规/风险评估_2025"></td>
              </tr>
              <tr>
                <td class="font-medium">其他</td>
                <td><input type="checkbox" name="C2_其他_2023"></td>
                <td><input type="checkbox" name="C2_其他_2024"></td>
                <td><input type="checkbox" name="C2_其他_2025"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C3 矩阵单选 -->
        <div>
          <label class="font-bold">您自评在各年份因 AI 带来的效率提升幅度（矩阵单选）<span class="required-star">*</span></label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">年份</th>
                <th>&lt;10%（含0%）</th>
                <th>10–30%</th>
                <th>30–50%</th>
                <th>50–100%</th>
                <th>&gt;100%</th>
                <th>不好说/未评估</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">2023 年</td>
                <td><input type="radio" name="C3_2023" value="<10%（含0%）"></td>
                <td><input type="radio" name="C3_2023" value="10–30%"></td>
                <td><input type="radio" name="C3_2023" value="30–50%"></td>
                <td><input type="radio" name="C3_2023" value="50–100%"></td>
                <td><input type="radio" name="C3_2023" value=">100%"></td>
                <td><input type="radio" name="C3_2023" value="不好说/未评估"></td>
              </tr>
              <tr>
                <td class="font-medium">2024 年</td>
                <td><input type="radio" name="C3_2024" value="<10%（含0%）"></td>
                <td><input type="radio" name="C3_2024" value="10–30%"></td>
                <td><input type="radio" name="C3_2024" value="30–50%"></td>
                <td><input type="radio" name="C3_2024" value="50–100%"></td>
                <td><input type="radio" name="C3_2024" value=">100%"></td>
                <td><input type="radio" name="C3_2024" value="不好说/未评估"></td>
              </tr>
              <tr>
                <td class="font-medium">2025 年</td>
                <td><input type="radio" name="C3_2025" value="<10%（含0%）"></td>
                <td><input type="radio" name="C3_2025" value="10–30%"></td>
                <td><input type="radio" name="C3_2025" value="30–50%"></td>
                <td><input type="radio" name="C3_2025" value="50–100%"></td>
                <td><input type="radio" name="C3_2025" value=">100%"></td>
                <td><input type="radio" name="C3_2025" value="不好说/未评估"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C4 矩阵单选 -->
        <div>
          <label class="font-bold">您的团队/组织是否有 AI 使用政策（矩阵单选）<span class="required-star">*</span></label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">年份</th>
                <th>无政策</th>
                <th>有非正式指南</th>
                <th>有正式政策但不强制</th>
                <th>有正式且强制政策</th>
                <th>不清楚</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">2023 年</td>
                <td><input type="radio" name="C4_2023" value="无政策"></td>
                <td><input type="radio" name="C4_2023" value="有非正式指南"></td>
                <td><input type="radio" name="C4_2023" value="有正式政策但不强制"></td>
                <td><input type="radio" name="C4_2023" value="有正式且强制政策"></td>
                <td><input type="radio" name="C4_2023" value="不清楚"></td>
              </tr>
              <tr>
                <td class="font-medium">2024 年</td>
                <td><input type="radio" name="C4_2024" value="无政策"></td>
                <td><input type="radio" name="C4_2024" value="有非正式指南"></td>
                <td><input type="radio" name="C4_2024" value="有正式政策但不强制"></td>
                <td><input type="radio" name="C4_2024" value="有正式且强制政策"></td>
                <td><input type="radio" name="C4_2024" value="不清楚"></td>
              </tr>
              <tr>
                <td class="font-medium">2025 年</td>
                <td><input type="radio" name="C4_2025" value="无政策"></td>
                <td><input type="radio" name="C4_2025" value="有非正式指南"></td>
                <td><input type="radio" name="C4_2025" value="有正式政策但不强制"></td>
                <td><input type="radio" name="C4_2025" value="有正式且强制政策"></td>
                <td><input type="radio" name="C4_2025" value="不清楚"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- C5 多选，每行一个 -->
        <div>
          <label class="font-bold">您在 2025 年常用的 AI/模型或平台（多选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="A"> ChatGPT 系列</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="B"> Claude</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="C"> Gemini</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="D"> DeepSeek</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="E"> Copilot（SAS/R/Python/VS Code 等）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="F"> 国产大模型（阿里/百度/字节/华为等）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="G"> 私有化/本地 LLM</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="H"> 公司自研工具</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="I"> 不了解/未关注</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="J"> 不方便透露</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="C5" value="K"> <span>其他：</span><input type="text" name="C5-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- C6 单选，每行一个 -->
        <div>
          <label class="font-bold">您在 2025 年用于处理含敏感数据的做法（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="A"> 从不在 AI 工具中输入敏感数据</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="B"> 仅在公司批准的安全环境中使用（如私有化、脱敏）</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="C"> 公司 AI 工具会自动屏蔽/脱敏敏感信息，我不作额外处理直接上传</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="D"> 在公开云工具中谨慎使用（删除标识/片段化）</label>
            <label class="flex items-center gap-2"><input type="radio" name="C6" value="E"> 不清楚/未关注</label>
          </div>
        </div>




      </div>

      <!-- C-DEEP. 深度用户专项 (条件显示) -->
      <div id="blockC-DEEP" class="bg-blue-50 border border-blue-200 rounded p-5 space-y-6 hidden">
        <h2 class="text-xl font-semibold text-blue-800">深度用户专项（针对经常使用AI的用户）</h2>
        <p class="text-sm text-blue-600">此部分仅对在2025年"经常"或"频繁"使用AI的用户显示</p>

        <!-- CD1 多选题 -->
        <div>
          <label class="font-bold">您在使用AI进行统计编程时，主要采用哪些prompt策略？（可多选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="A"> 直接描述需求，让AI生成完整代码</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="B"> 提供代码框架，让AI填充具体实现</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="C"> 分步骤引导，逐步构建复杂逻辑</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="D"> 提供示例代码，要求AI模仿风格</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="E"> 角色扮演（如"你是SAS专家"）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="F"> 提供上下文（数据结构、业务背景）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="G"> 要求解释代码逻辑与思路</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD1" value="H"> <span>其他策略：</span><input type="text" name="CD1-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- CD2 单选题 -->
        <div>
          <label class="font-bold">您认为目前AI在以下哪个统计编程任务上表现最佳？（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="A"> 基础数据操作（筛选、排序、合并）</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="B"> 标准统计分析（描述性统计、t检验等）</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="C"> 复杂数据清洗与转换逻辑</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="D"> 图表制作与美化</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="E"> 代码注释与文档生成</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="F"> 错误调试与代码优化</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD2" value="G"> 都表现一般</label>
          </div>
        </div>

        <!-- CD3 多选题 -->
        <div>
          <label class="font-bold">您在深度使用AI的过程中，遇到过哪些典型问题？（可多选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="A"> 生成的代码语法错误或无法运行</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="B"> 逻辑错误，结果看似合理但实际有误</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="C"> 不理解特定领域术语（如CDISC标准）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="D"> 代码效率低下，运行速度慢</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="E"> 风格不一致，难以维护</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="F"> 过度复杂化简单问题</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="G"> 无法处理边界情况或异常数据</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="H"> 版本间不一致（同样问题不同回答）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD3" value="I"> <span>其他问题：</span><input type="text" name="CD3-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- CD4 单选题 -->
        <div>
          <label class="font-bold">您通常如何验证AI生成代码的正确性？（单选最主要的方法）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="A"> 逐行检查代码逻辑</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="B"> 用已知结果的测试数据验证</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="C"> 与传统方法的结果对比</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="D"> 同事peer review</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="E"> 分步运行，检查中间结果</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="F"> 直接使用，出问题再修正</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD4" value="G"> 多个AI工具交叉验证</label>
          </div>
        </div>

        <!-- CD5 矩阵单选题 -->
        <div>
          <label class="font-bold">您对AI在不同复杂度任务上的信任程度<span class="required-star">*</span></label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">任务复杂度</th>
                <th>完全信任</th>
                <th>基本信任</th>
                <th>谨慎验证</th>
                <th>严格校验</th>
                <th>不敢使用</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="font-medium">简单重复任务（如数据导入）</td>
                <td><input type="radio" name="CD5_simple" value="完全信任"></td>
                <td><input type="radio" name="CD5_simple" value="基本信任"></td>
                <td><input type="radio" name="CD5_simple" value="谨慎验证"></td>
                <td><input type="radio" name="CD5_simple" value="严格校验"></td>
                <td><input type="radio" name="CD5_simple" value="不敢使用"></td>
              </tr>
              <tr>
                <td class="font-medium">中等复杂度（如多表关联分析）</td>
                <td><input type="radio" name="CD5_medium" value="完全信任"></td>
                <td><input type="radio" name="CD5_medium" value="基本信任"></td>
                <td><input type="radio" name="CD5_medium" value="谨慎验证"></td>
                <td><input type="radio" name="CD5_medium" value="严格校验"></td>
                <td><input type="radio" name="CD5_medium" value="不敢使用"></td>
              </tr>
              <tr>
                <td class="font-medium">高复杂度（如临床终点分析）</td>
                <td><input type="radio" name="CD5_complex" value="完全信任"></td>
                <td><input type="radio" name="CD5_complex" value="基本信任"></td>
                <td><input type="radio" name="CD5_complex" value="谨慎验证"></td>
                <td><input type="radio" name="CD5_complex" value="严格校验"></td>
                <td><input type="radio" name="CD5_complex" value="不敢使用"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- CD6 开放题 -->
        <div>
          <label class="font-bold">请分享一个AI显著帮助您解决的具体技术难题：</label>
          <textarea name="CD6" rows="3" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="如：AI帮我解决了某个复杂的数据清洗逻辑，原本需要...，AI建议...，最终节省了...时间"></textarea>
        </div>

        <!-- CD7 多选题 -->
        <div>
          <label class="font-bold">您希望AI工具在哪些方面得到改进？（可多选，最多5项）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="A"> 更好的领域知识（CDISC/ICH等标准）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="B"> 更强的代码调试与错误定位能力</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="C"> 更好的代码风格一致性</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="D"> 支持更复杂的多步骤任务</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="E"> 更准确的性能优化建议</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="F"> 更好的文档与注释生成</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="G"> 支持团队协作与代码标准化</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="H"> 更强的数据安全与隐私保护</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="I"> 更便宜的使用成本</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="J"> 更快的响应速度</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="CD7" value="K"> <span>其他改进：</span><input type="text" name="CD7-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- CD8 单选题 -->
        <div>
          <label class="font-bold">如果AI持续改进，您预计多久后能在关键项目中放心使用AI生成的核心代码？<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="CD8" value="A"> 现在就可以（已经在用）</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD8" value="B"> 6个月内</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD8" value="C"> 1-2年内</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD8" value="D"> 3-5年内</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD8" value="E"> 5年以上</label>
            <label class="flex items-center gap-2"><input type="radio" name="CD8" value="F"> 永远不会完全放心</label>
          </div>
        </div>

        <!-- CD9 开放题 -->
        <div>
          <label class="font-bold">作为AI深度用户，您对同行有什么使用建议？</label>
          <textarea name="CD9" rows="3" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="如：推荐从...开始，注意...，避免..."></textarea>
        </div>
      </div>

      <!-- D. 态度 -->
      <div id="blockD" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">您对 AI 的态度（2023–2025 年对比）</h2>

        <div>
          <label class="font-bold">您对以下陈述在各年份的看法（矩阵单选）<span class="required-star">*</span></label>
          <table class="matrix w-full mt-2 text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left">陈述/年份</th>
                <th>非常不同意</th>
                <th>不同意</th>
                <th>中立</th>
                <th>同意</th>
                <th>非常同意</th>
              </tr>
            </thead>
            <tbody>
              <!-- AI 提升统计编程效率 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 提升统计编程效率</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_1" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_1" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_1" value="中立"></td>
                <td><input type="radio" name="D1_2023年_1" value="同意"></td>
                <td><input type="radio" name="D1_2023年_1" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_1" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_1" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_1" value="中立"></td>
                <td><input type="radio" name="D1_2024年_1" value="同意"></td>
                <td><input type="radio" name="D1_2024年_1" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_1" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_1" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_1" value="中立"></td>
                <td><input type="radio" name="D1_2025年_1" value="同意"></td>
                <td><input type="radio" name="D1_2025年_1" value="非常同意"></td>
              </tr>

              <!-- AI 有助于减少低级错误 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 有助于减少低级错误</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_2" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_2" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_2" value="中立"></td>
                <td><input type="radio" name="D1_2023年_2" value="同意"></td>
                <td><input type="radio" name="D1_2023年_2" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_2" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_2" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_2" value="中立"></td>
                <td><input type="radio" name="D1_2024年_2" value="同意"></td>
                <td><input type="radio" name="D1_2024年_2" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_2" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_2" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_2" value="中立"></td>
                <td><input type="radio" name="D1_2025年_2" value="同意"></td>
                <td><input type="radio" name="D1_2025年_2" value="非常同意"></td>
              </tr>

              <!-- AI 增加合规/审计风险（反向） -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 增加合规/审计风险（反向）</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_3" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_3" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_3" value="中立"></td>
                <td><input type="radio" name="D1_2023年_3" value="同意"></td>
                <td><input type="radio" name="D1_2023年_3" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_3" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_3" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_3" value="中立"></td>
                <td><input type="radio" name="D1_2024年_3" value="同意"></td>
                <td><input type="radio" name="D1_2024年_3" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_3" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_3" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_3" value="中立"></td>
                <td><input type="radio" name="D1_2025年_3" value="同意"></td>
                <td><input type="radio" name="D1_2025年_3" value="非常同意"></td>
              </tr>

              <!-- AI 对初级岗位替代风险高（反向） -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 对初级岗位替代风险高（反向）</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_4" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_4" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_4" value="中立"></td>
                <td><input type="radio" name="D1_2023年_4" value="同意"></td>
                <td><input type="radio" name="D1_2023年_4" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_4" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_4" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_4" value="中立"></td>
                <td><input type="radio" name="D1_2024年_4" value="同意"></td>
                <td><input type="radio" name="D1_2024年_4" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_4" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_4" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_4" value="中立"></td>
                <td><input type="radio" name="D1_2025年_4" value="同意"></td>
                <td><input type="radio" name="D1_2025年_4" value="非常同意"></td>
              </tr>

              <!-- AI 有助于学习与知识传承 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 有助于学习与知识传承</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_5" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_5" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_5" value="中立"></td>
                <td><input type="radio" name="D1_2023年_5" value="同意"></td>
                <td><input type="radio" name="D1_2023年_5" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_5" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_5" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_5" value="中立"></td>
                <td><input type="radio" name="D1_2024年_5" value="同意"></td>
                <td><input type="radio" name="D1_2024年_5" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_5" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_5" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_5" value="中立"></td>
                <td><input type="radio" name="D1_2025年_5" value="同意"></td>
                <td><input type="radio" name="D1_2025年_5" value="非常同意"></td>
              </tr>

              <!-- AI 适合用于注册申报交付环节 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 适合用于注册申报交付环节</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_6" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_6" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_6" value="中立"></td>
                <td><input type="radio" name="D1_2023年_6" value="同意"></td>
                <td><input type="radio" name="D1_2023年_6" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_6" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_6" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_6" value="中立"></td>
                <td><input type="radio" name="D1_2024年_6" value="同意"></td>
                <td><input type="radio" name="D1_2024年_6" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_6" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_6" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_6" value="中立"></td>
                <td><input type="radio" name="D1_2025年_6" value="同意"></td>
                <td><input type="radio" name="D1_2025年_6" value="非常同意"></td>
              </tr>

              <!-- AI 的输出需要严格的人审/双编 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">AI 的输出需要严格的人审/双编</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_7" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_7" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_7" value="中立"></td>
                <td><input type="radio" name="D1_2023年_7" value="同意"></td>
                <td><input type="radio" name="D1_2023年_7" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_7" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_7" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_7" value="中立"></td>
                <td><input type="radio" name="D1_2024年_7" value="同意"></td>
                <td><input type="radio" name="D1_2024年_7" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_7" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_7" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_7" value="中立"></td>
                <td><input type="radio" name="D1_2025年_7" value="同意"></td>
                <td><input type="radio" name="D1_2025年_7" value="非常同意"></td>
              </tr>

              <!-- 我对 AI 在专业场景下的可信度更高 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">我对 AI 在专业场景下的可信度更高</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_8" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_8" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_8" value="中立"></td>
                <td><input type="radio" name="D1_2023年_8" value="同意"></td>
                <td><input type="radio" name="D1_2023年_8" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_8" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_8" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_8" value="中立"></td>
                <td><input type="radio" name="D1_2024年_8" value="同意"></td>
                <td><input type="radio" name="D1_2024年_8" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_8" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_8" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_8" value="中立"></td>
                <td><input type="radio" name="D1_2025年_8" value="同意"></td>
                <td><input type="radio" name="D1_2025年_8" value="非常同意"></td>
              </tr>

              <!-- 我乐于向团队推广 AI 最佳实践 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">我乐于向团队推广 AI 最佳实践</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_9" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_9" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_9" value="中立"></td>
                <td><input type="radio" name="D1_2023年_9" value="同意"></td>
                <td><input type="radio" name="D1_2023年_9" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_9" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_9" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_9" value="中立"></td>
                <td><input type="radio" name="D1_2024年_9" value="同意"></td>
                <td><input type="radio" name="D1_2024年_9" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_9" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_9" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_9" value="中立"></td>
                <td><input type="radio" name="D1_2025年_9" value="同意"></td>
                <td><input type="radio" name="D1_2025年_9" value="非常同意"></td>
              </tr>

              <!-- 公司应加大 AI 培训与投入 -->
              <tr><td colspan="6" class="bg-gray-50 font-semibold">公司应加大 AI 培训与投入</td></tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2023年</td>
                <td><input type="radio" name="D1_2023年_10" value="非常不同意"></td>
                <td><input type="radio" name="D1_2023年_10" value="不同意"></td>
                <td><input type="radio" name="D1_2023年_10" value="中立"></td>
                <td><input type="radio" name="D1_2023年_10" value="同意"></td>
                <td><input type="radio" name="D1_2023年_10" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2024年</td>
                <td><input type="radio" name="D1_2024年_10" value="非常不同意"></td>
                <td><input type="radio" name="D1_2024年_10" value="不同意"></td>
                <td><input type="radio" name="D1_2024年_10" value="中立"></td>
                <td><input type="radio" name="D1_2024年_10" value="同意"></td>
                <td><input type="radio" name="D1_2024年_10" value="非常同意"></td>
              </tr>
              <tr>
                <td class="indent-row font-normal text-gray-600">2025年</td>
                <td><input type="radio" name="D1_2025年_10" value="非常不同意"></td>
                <td><input type="radio" name="D1_2025年_10" value="不同意"></td>
                <td><input type="radio" name="D1_2025年_10" value="中立"></td>
                <td><input type="radio" name="D1_2025年_10" value="同意"></td>
                <td><input type="radio" name="D1_2025年_10" value="非常同意"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- D2 单选题 -->
        <div>
          <label class="font-bold">您预计未来 1 年 AI 在统计编程行业的影响（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="A"> 进一步增强生产力，形成行业刚需</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="B"> 有助提升，但影响有限</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="C"> 与现有工具类似，不会显著改变行业</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="D"> 可能带来负面影响（如技能退化、过度依赖）</label>
            <label class="flex items-center gap-2"><input type="radio" name="D2" value="E"> 不确定/难以预测</label>
          </div>
        </div>

        <!-- D3 多选题 -->
        <div>
          <label class="font-bold">您认为哪些因素最制约 AI 在统计编程中的应用（多选，最多3项）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="A"> 数据安全与隐私合规风险</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="B"> AI输出的准确性与可信度不足</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="C"> 缺乏针对性的AI工具与平台</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="D"> 公司政策限制或缺乏明确指导</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="E"> 团队技能与培训不足</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="F"> 成本考虑（license、计算资源等）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="G"> 审计追踪与可重现性要求</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="H"> 监管部门对AI使用的不确定态度</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="D3" value="I"> <span>其他：</span><input type="text" name="D3-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- D4 单选题 -->
        <div>
          <label class="font-bold">您倾向于在哪些情境下更信任 AI 的建议（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="A"> 重复性高、标准化的编程任务</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="B"> 有明确业务逻辑、可校验的分析</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="C"> 初期探索、获取灵感的阶段</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="D"> 有充足时间进行验证的项目</label>
            <label class="flex items-center gap-2"><input type="radio" name="D4" value="E"> 都不信任，仅作参考</label>
          </div>
        </div>
      </div>

      <!-- E. 展望与建议 -->
      <div id="blockE" class="bg-white rounded border p-5 space-y-6">
        <h2 class="text-xl font-semibold">展望与建议</h2>

        <!-- E1 多选题 -->
        <div>
          <label class="font-bold">您认为最需要 AI 改进的统计编程环节（多选，最多3项）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="A"> 代码生成与优化（提高代码质量与效率）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="B"> 数据清洗与转换的自动化</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="C"> 质量控制与校验（QC自动化）</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="D"> 技术文档生成与维护</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="E"> 知识管理与最佳实践检索</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="F"> 合规性检查与风险评估</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="G"> 培训与技能提升辅助</label>
            <label class="flex items-center gap-2"><input type="checkbox" name="E1" value="H"> <span>其他：</span><input type="text" name="E1-OTHER" class="border rounded px-2 py-1 text-sm ml-2 flex-1" placeholder="请填写" disabled></label>
          </div>
        </div>

        <!-- E2 单选题 -->
        <div>
          <label class="font-bold">您对公司 AI 政策的建议（单选）<span class="required-star">*</span></label>
          <div class="mt-2 space-y-2">
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="A"> 制定更明确的使用指南与边界</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="B"> 加大 AI 工具与基础设施投入</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="C"> 增加相关培训与能力建设</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="D"> 建立最佳实践分享与交流机制</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="E"> 保持现状，观望发展</label>
            <label class="flex items-center gap-2"><input type="radio" name="E2" value="F"> 更谨慎使用，加强风险控制</label>
          </div>
        </div>

        <!-- E3 开放题 -->
        <div>
          <label class="font-bold">如果让您向同行推荐，您会如何描述 AI 在统计编程中的价值？</label>
          <textarea name="E3" rows="3" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="可选填写，如'AI帮我提升了...，但需要注意...'"></textarea>
        </div>

        <!-- E4 排序题 -->
        <div>
          <label class="font-bold">以下哪个 AI 发展方向对您最有吸引力（拖拽排序，1最重要）<span class="required-star">*</span></label>
          <p class="text-sm text-gray-600 mt-1">请拖拽下方选项进行排序，排在最上方的为最重要（移动端：长按拖拽）</p>
          <ul id="E4_sortable" class="mt-3 space-y-2">
            <li class="sortable-item bg-gray-50 border rounded p-3 cursor-move flex items-center" data-value="A">
              <span class="drag-handle mr-3 text-gray-400">⋮⋮</span>
              <span class="rank-number bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3">1</span>
              <span>更准确的领域专用模型</span>
            </li>
            <li class="sortable-item bg-gray-50 border rounded p-3 cursor-move flex items-center" data-value="B">
              <span class="drag-handle mr-3 text-gray-400">⋮⋮</span>
              <span class="rank-number bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3">2</span>
              <span>更强的代码理解与生成能力</span>
            </li>
            <li class="sortable-item bg-gray-50 border rounded p-3 cursor-move flex items-center" data-value="C">
              <span class="drag-handle mr-3 text-gray-400">⋮⋮</span>
              <span class="rank-number bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3">3</span>
              <span>更好的安全性与隐私保护</span>
            </li>
            <li class="sortable-item bg-gray-50 border rounded p-3 cursor-move flex items-center" data-value="D">
              <span class="drag-handle mr-3 text-gray-400">⋮⋮</span>
              <span class="rank-number bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3">4</span>
              <span>更便宜的使用成本</span>
            </li>
            <li class="sortable-item bg-gray-50 border rounded p-3 cursor-move flex items-center" data-value="E">
              <span class="drag-handle mr-3 text-gray-400">⋮⋮</span>
              <span class="rank-number bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3">5</span>
              <span>更完善的生态与工具集成</span>
            </li>
          </ul>
          <input type="hidden" name="E4_A" value="1">
          <input type="hidden" name="E4_B" value="2">
          <input type="hidden" name="E4_C" value="3">
          <input type="hidden" name="E4_D" value="4">
          <input type="hidden" name="E4_E" value="5">
        </div>
      </div>

      <!-- F. 开放反馈 -->
      <div id="blockF" class="bg-white rounded border p-5 space-y-4">
        <h2 class="text-xl font-semibold">开放反馈</h2>
        
        <div>
          <label class="font-bold">您对本次调研或 AI 在统计编程领域的其他建议：</label>
          <textarea name="F1" rows="4" class="w-full border rounded px-2 py-1 text-sm mt-2" placeholder="可选填写您的任何建议、意见或补充..."></textarea>
        </div>


      </div>

      <!-- 提交区域 -->
      <div class="bg-white rounded border p-5">
        <div class="text-center">
          <button type="submit" class="btn btn-primary">📤 提交问卷</button>
          <div class="mt-3">
            <span class="text-sm text-gray-500">提交前请检查必填项是否完整</span>
          </div>
        </div>
        
        <div class="mt-4 text-xs text-gray-500">
          <p>* 问卷数据将用于学术研究，不会泄露个人隐私信息</p>
          <p>* 如有疑问，请<a href="mailto:jsong67@its.jnj.com;CTian17@ITS.JNJ.com;hao1.chen@beigene.com?subject=中国药物研发统计编程行业AI使用与态度问卷咨询" class="text-blue-600 hover:text-blue-800 underline">联系我们</a></p>
        </div>
      </div>
    </form>

    <!-- 提交成功提示 -->
    <div id="submitSuccess" class="hidden section-card mt-6">
      <div class="p-8 text-center">
        <div class="text-6xl mb-4">🎉</div>
        <h3 class="text-2xl font-bold text-green-800 mb-4">问卷已完成！</h3>
        <p class="text-green-700 text-lg mb-6">感谢您的参与！</p>
        <div class="text-green-600 space-y-3">
          <p class="text-base font-medium">📅 调查结果将于 <strong>2025年11月7日</strong> 发布</p>
          <p>🌍 发布地点：PHUSE SDE 及线上同时发布</p>
        </div>
      </div>
    </div>


    
    </div>
    
    <!-- Contact Us -->
    <footer class="bg-gray-100 border-t p-6">
    </footer>
  </div>

  <script>
    // Firebase配置
    const firebaseConfig = {
      apiKey: "{{API_KEY}}",
      authDomain: "phuse-ai-survey.firebaseapp.com",
      databaseURL: "https://phuse-ai-survey-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "phuse-ai-survey",
      storageBucket: "phuse-ai-survey.firebasestorage.app",
      messagingSenderId: "924577570091",
      appId: "1:924577570091:web:d7a96aa331b86ccc4b796e",
      measurementId: "G-X54Z7YHTDC"
    };
    
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('surveyForm');
      const submitSuccess = document.getElementById('submitSuccess');
      
      // S1 逻辑 - 选择"否"时显示结束消息并隐藏后续问题
      const s1Inputs = document.querySelectorAll('input[name="S1"]');
      const subsequentSections = document.querySelectorAll('#blockA > div:not(:first-child) > div:not([id="endMsgS1"]):not([id="sSectionValidation"]), #blockB, #blockC, #blockC-DEEP, #blockD, #blockE, #blockF, .bg-white.rounded.border');
      
      s1Inputs.forEach(input => {
        input.addEventListener('change', function() {
          const endMsg = document.getElementById('endMsgS1');
          if (this.value === 'B' && this.checked) {
            endMsg.classList.remove('hidden');
            // 隐藏除第一题以外的所有题目
            document.querySelectorAll('#blockA > div:nth-child(n+4)').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('#blockC, #blockC-DEEP, #blockD, #blockE, #blockF, .bg-white.rounded.border:not(#blockA)').forEach(el => el.classList.add('hidden'));
          } else {
            endMsg.classList.add('hidden');
            // 显示所有题目
            document.querySelectorAll('#blockA > div:nth-child(n+4)').forEach(el => el.classList.remove('hidden'));
            document.querySelectorAll('#blockC, #blockC-DEEP, #blockD, #blockE, #blockF, .bg-white.rounded.border:not(#blockA)').forEach(el => el.classList.remove('hidden'));
          }
        });
      });
      
      // S5 深度用户专项显示逻辑
      const s5Inputs = document.querySelectorAll('input[name="S5"]');
      const deepBlock = document.getElementById('blockC-DEEP');
      s5Inputs.forEach(input => {
        input.addEventListener('change', function() {
          if ((this.value === 'D' || this.value === 'E') && this.checked) {
            deepBlock.classList.remove('hidden');
          } else {
            deepBlock.classList.add('hidden');
          }
        });
      });
      
      // 多选框"其他"选项的文本框联动
      const otherCheckboxes = document.querySelectorAll('input[type="checkbox"][value*="其他"], input[type="checkbox"][value="K"], input[type="checkbox"][value="I"], input[type="checkbox"][value="H"]');
      otherCheckboxes.forEach(checkbox => {
        const textInput = checkbox.parentElement.querySelector('input[type="text"]');
        if (textInput) {
          checkbox.addEventListener('change', function() {
            textInput.disabled = !this.checked;
            if (!this.checked) textInput.value = '';
          });
        }
      });
      

      
      // D3 多选限制（最多3项）
      const d3Checkboxes = document.querySelectorAll('input[name="D3"]');
      d3Checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const checkedD3 = document.querySelectorAll('input[name="D3"]:checked');
          if (checkedD3.length > 3) {
            this.checked = false;
            alert('最多只能选择3项');
          }
        });
      });
      
      // CD7 多选限制（最多5项）
      const cd7Checkboxes = document.querySelectorAll('input[name="CD7"]');
      cd7Checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const checkedCD7 = document.querySelectorAll('input[name="CD7"]:checked');
          if (checkedCD7.length > 5) {
            this.checked = false;
            alert('最多只能选择5项');
          }
        });
      });
      
      // E4 拖拽排序功能（支持桌面和移动端）
      const sortableList = document.getElementById('E4_sortable');
      let draggedElement = null;
      let touchStartY = 0;
      let touchElement = null;
      
      // 桌面端拖拽
      sortableList.addEventListener('dragstart', function(e) {
        draggedElement = e.target.closest('.sortable-item');
        draggedElement.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
      });
      
      sortableList.addEventListener('dragend', function(e) {
        if (draggedElement) {
          draggedElement.classList.remove('dragging');
          draggedElement = null;
        }
      });
      
      sortableList.addEventListener('dragover', function(e) {
        e.preventDefault();
        const afterElement = getDragAfterElement(sortableList, e.clientY);
        if (afterElement == null) {
          sortableList.appendChild(draggedElement);
        } else {
          sortableList.insertBefore(draggedElement, afterElement);
        }
        updateRankNumbers();
      });
      
      // 移动端触摸支持
      sortableList.addEventListener('touchstart', function(e) {
        touchElement = e.target.closest('.sortable-item');
        if (touchElement) {
          touchStartY = e.touches[0].clientY;
          touchElement.classList.add('dragging');
        }
      });
      
      sortableList.addEventListener('touchmove', function(e) {
        if (!touchElement) return;
        e.preventDefault();
        
        const touch = e.touches[0];
        const afterElement = getDragAfterElement(sortableList, touch.clientY);
        
        if (afterElement == null) {
          sortableList.appendChild(touchElement);
        } else {
          sortableList.insertBefore(touchElement, afterElement);
        }
        updateRankNumbers();
      });
      
      sortableList.addEventListener('touchend', function(e) {
        if (touchElement) {
          touchElement.classList.remove('dragging');
          touchElement = null;
        }
      });
      
      // 使所有排序项可拖拽
      document.querySelectorAll('.sortable-item').forEach(item => {
        item.draggable = true;
        item.style.touchAction = 'none'; // 防止移动端滚动干扰
      });
      
      function getDragAfterElement(container, y) {
        const draggableElements = [...container.querySelectorAll('.sortable-item:not(.dragging)')];
        return draggableElements.reduce((closest, child) => {
          const box = child.getBoundingClientRect();
          const offset = y - box.top - box.height / 2;
          if (offset < 0 && offset > closest.offset) {
            return { offset: offset, element: child };
          } else {
            return closest;
          }
        }, { offset: Number.NEGATIVE_INFINITY }).element;
      }
      
      function updateRankNumbers() {
        const items = document.querySelectorAll('#E4_sortable .sortable-item');
        items.forEach((item, index) => {
          const rankNumber = item.querySelector('.rank-number');
          rankNumber.textContent = index + 1;
          const value = item.dataset.value;
          document.querySelector(`input[name="E4_${value}"]`).value = index + 1;
        });
      }
      

      

      
      // 表单提交处理
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // 基本验证
        const requiredFields = form.querySelectorAll('[required]');
        let valid = true;
        let missingFields = [];
        
        requiredFields.forEach(field => {
          let fieldValid = false;
          
          if (field.type === 'radio') {
            fieldValid = form.querySelector(`input[name="${field.name}"]:checked`) !== null;
          } else if (field.type === 'checkbox') {
            const checkboxGroup = form.querySelectorAll(`input[name="${field.name}"]`);
            fieldValid = Array.from(checkboxGroup).some(cb => cb.checked);
          } else {
            fieldValid = field.value.trim() !== '';
          }
          
          if (!fieldValid) {
            valid = false;
            missingFields.push(field.name);
            field.style.borderColor = '#ef4444';
          } else {
            field.style.borderColor = '';
          }
        });
        
        // B4问题的自定义验证
        const b4Checkboxes = form.querySelectorAll('input[name="B4"]:checked');
        if (b4Checkboxes.length === 0) {
          valid = false;
          missingFields.push('B4');
        }
        
        if (!valid) {
          alert('请完成以下必填项：' + missingFields.join(', '));
          const firstMissing = form.querySelector(`[name="${missingFields[0]}"]`);
          if (firstMissing) {
            firstMissing.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
          return;
        }
        
        // 更新E4排序数据
        updateRankNumbers();
        
        // 收集表单数据
        const formData = new FormData(form);
        const data = {};
        
        // 清理键名函数 - 移除Firebase不允许的字符
        function cleanKey(key) {
          return key.replace(/[.#$\[\]/]/g, '_').replace(/\//g, '_');
        }
        
        for (let [key, value] of formData.entries()) {
          const cleanedKey = cleanKey(key);
          if (data[cleanedKey]) {
            if (Array.isArray(data[cleanedKey])) {
              data[cleanedKey].push(value);
            } else {
              data[cleanedKey] = [data[cleanedKey], value];
            }
          } else {
            data[cleanedKey] = value;
          }
        }
        
        data._timestamp = new Date().toISOString();
        data._version = "2025.1";
        
        // 保存到Firebase
        data.timestamp = firebase.database.ServerValue.TIMESTAMP;
        
        database.ref('surveys').push(data)
          .then(() => {
            // 隐藏填写说明
            document.querySelector('section.mb-6').style.display = 'none';
            
            submitSuccess.classList.remove('hidden');
            form.style.display = 'none';
            submitSuccess.scrollIntoView({ behavior: 'smooth' });
          })
          .catch((error) => {
            alert('提交失败，请稍后重试。');
          });
      });

    });
  </script>
</body>
</html>
